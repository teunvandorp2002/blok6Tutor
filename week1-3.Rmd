---
title: "De mooiste RMarkdown"
author: "Teun van Dorp, Luc Hengeveld, Michelle Memelink"
date: "11/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r aanmaken}
library(edgeR)
fDir <-  "/home/teun/Documents/HAN/Jaar 2/Blok 6/R markdown/"
fName <- "WCFS1_cnts.txt"

cnts <- read.delim(paste0(fDir,fName), comment.char="#")

row.names(cnts) <- cnts[,"ID"]

exp <- c("WCFS1.glc","WCFS1.glc","WCFS1.rib","WCFS1.rib")

group <- factor(exp)
y <- DGEList(counts=cnts[,2:5],group=group)

print("Count statistics")
print(summary(y$counts))
print(y$samples)

design <- model.matrix(~0+group, data=y$samples)
colnames(design) <- levels(y$samples$group)
print(design)

y <- estimateGLMCommonDisp(y,design)
y <- estimateGLMTrendedDisp(y,design, method="power")
y <- estimateGLMTagwiseDisp(y,design)

pdf(paste0(fDir,"LP_edgeR.pdf"))
plotMDS(y)
plotBCV(y)
dev.off()

fit <- glmFit(y,design)

mc <- makeContrasts(exp.r=WCFS1.glc-WCFS1.rib, levels=design)

fit <- glmLRT(fit, contrast=mc)

res<-topTags(fit)
print(res)
```